<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Audio‐Reactive Maze Visualizer + Spotify</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="visualizer.css">
</head>
<body>
  <!-- …your existing Three.js canvas and other panels… -->

  <div class="spectrum-analyzer" id="spectrum-analyzer-panel">
    <div class="spectrum-header">
      <span>AUDIO SPECTRUM & CONTROLS</span>
    </div>
    <span class="panel-handle">⋮⋮</span>
    <div class="spectrum-content">
      <canvas id="spectrum-canvas"></canvas>
    </div>

    <!-- SOURCE TABS -->
    <div class="control-row" style="display:flex; gap:0.5rem; justify-content:center; margin-top:1rem;">
      <button class="btn source-tab active" data-source="demo">Demo</button>
      <button class="btn source-tab" data-source="upload">Upload</button>
      <button class="btn source-tab" data-source="spotify">Spotify</button>
    </div>

    <!-- DEMO TRACKS -->
    <div class="panel-body" data-panel="demo" style="margin-top:0.8rem;">
      <span>DEMO TRACKS:</span>
      <div style="display:flex; flex-wrap:wrap; gap:0.5rem; margin-top:0.5rem;">
        <button class="btn demo-track-btn" data-url="https://assets.codepen.io/7558/Merkaba.mp3">MERKABA</button>
        <!-- …other demo buttons… -->
      </div>
    </div>

    <!-- UPLOAD -->
    <div class="panel-body" data-panel="upload" style="display:none; margin-top:0.8rem;">
      <input type="file" id="audio-file-input" accept="audio/*" />
      <button class="btn" id="file-btn">UPLOAD AUDIO</button>
      <div id="file-label">NO FILE SELECTED</div>
    </div>

    <!-- SPOTIFY PLAYBACK & BROWSING -->
    <div class="panel-body" data-panel="spotify" style="display:none; margin-top:0.8rem;">
      <button class="btn" id="btn-spotify-connect">Connect to Spotify</button>
      <div id="spotify-player-container" style="margin-top:0.6rem;">Waiting to connect…</div>

      <!-- playback controls -->
      <div id="spotify-controls" style="margin-top:0.6rem; display:flex; gap:0.5rem; justify-content:center;">
        <button class="btn" id="btn-prev">⏮️</button>
        <button class="btn" id="btn-play">▶️/⏸️</button>
        <button class="btn" id="btn-next">⏭️</button>
      </div>

      <!-- playlist + track browser -->
      <div id="spotify-browse" style="margin-top:1rem;">
        <select id="spotify-playlists" style="width:100%; padding:0.5rem; margin-bottom:0.5rem;">
          <option>Loading playlists…</option>
        </select>
        <ul id="spotify-tracks" style="list-style:none; padding:0; max-height:200px; overflow-y:auto; border:1px solid #444;">
          <!-- track items go here -->
        </ul>
      </div>

      <!-- volume -->
      <div class="control-group" style="margin-top:1rem;">
        <label for="spotify-volume" class="control-label">Volume</label>
        <input type="range" id="spotify-volume" min="0" max="1" step="0.01" class="slider" />
      </div>
    </div>
  </div>

  <!-- Spotify SDK + helper -->
  <script src="https://sdk.scdn.co/spotify-player.js"></script>
  <script type="module" src="spotify-player.js"></script>
  <!-- your existing visualizer logic -->
  <script type="module" src="main-visualizer.js"></script>
</body>
</html>